--EMPLOYEE TABLE

CREATE  TABLE EMPPLOYEE
(
	EMP_ID INT,
	EMP_NAME VARCHAR(50),
	EMP_SALARY INT
)

SELECT * FROM EMPPLOYEE  

DROP TABLE VW_EMPP

INSERT INTO EMPPLOYEE VALUES (1,'ANU',34000)
INSERT INTO EMPPLOYEE VALUES (2,'PRIYA',45000)
INSERT INTO EMPPLOYEE VALUES (3,'KIRTI',56000)
INSERT INTO EMPPLOYEE VALUES (4,'NITHYA',65000)


--DEPARTMENT TABLE

CREATE TABLE DEPPARTMENT
(
	DEPT_ID INT,
	DEPT_NAME VARCHAR(50)
)

SELECT * FROM DEPPARTMENT 

INSERT INTO DEPPARTMENT VALUES (1,'HR')
INSERT INTO DEPPARTMENT VALUES (2,'MANAGER')
INSERT INTO DEPPARTMENT VALUES (3,'TRAINEE')

--VIEW

CREATE VIEW VW_EMPPLOYEE 
AS
SELECT E.EMP_ID, E.EMP_NAME, E.EMP_SALARY, D.DEPT_NAME
FROM EMPPLOYEE AS E
INNER JOIN DEPPARTMENT AS D 
ON E.EMP_ID = D.DEPT_ID

DROP VIEW VW_EMPPLOYEE 

UPDATE DEPPARTMENT SET DEPT_NAME = '' WHERE DEPT_ID = 1

SELECT * FROM VW_EMPPLOYEE
